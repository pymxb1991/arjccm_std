<%@ page contentType="text/html;charset=UTF-8"%>
<%@ include file="/WEB-INF/views/include/taglib.jsp"%>
<html>
<head>
<title>装备物资管理</title>
<meta name="decorator" content="default" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script type="text/javascript">
	$(document).ready(function() {
		$('#btnSubmit').click(function(){
			$('#searchForm').submit();
		});
	});
	function page(n, s) {
		$("#pageNo").val(n);
		$("#pageSize").val(s);
		$("#searchForm").submit();
		return false;
	}
</script>
</head>
<body>
	<ul class="nav nav-tabs">
		<li class="active"><a href="${ctx}/storage/plmEquipment/countByEquType">库存统计列表</a></li>
	</ul>
	<form:form id="searchForm" modelAttribute="plmEquipment"
		action="${ctx}/storage/plmEquipment/countByEquType" method="post"
		class="breadcrumb form-search">
		<input id="pageNo" name="pageNo" type="hidden" value="${page.pageNo}" />
		<input id="pageSize" name="pageSize" type="hidden"
			value="${page.pageSize}" />
		<ul class="ul-form">
			<li><label>物资类别：</label> <form:select path="typeId"
					class="input-medium" dictTyep="plm_equipment_type">
					<form:option value="" label="未选择" />
					<form:options items="${fns:getDictList('plm_equipment_type')}"
						itemLabel="label" itemValue="value" htmlEscape="false" />
				</form:select></li>
			<li><label>物资子类：</label> <form:select path="typeChild"
					class="input-medium">
					<form:option value="" label="未选择" />
					<form:options
						items="${fns:getDictList('plm_equipment_type_child')}"
						itemLabel="label" itemValue="value" htmlEscape="false" />
				</form:select></li>
			<li class="btns"><a id="btnSubmit" class="btn btn-primary" href="javascript:;"><i class="icon-search"></i> 查询</a></li>
			<li class="clearfix"></li>
		</ul>
	</form:form>
	<sys:message content="${message}" />
	<div style="color: red;text-align: right;">默认显示非耗材(如需查看耗材请选择类别为耗材进行查询)</div>
		<table id="contentTable"
			class="table table-striped table-bordered table-condensed">
			<thead>
				<tr>
					<th>物资型号</th>
					<th>物资类别</th>
					<th>物资子类</th>
					<th>总数量</th>
					<th>占用数量</th>
					<th>空闲数量</th>
					<th>维修保养数量</th>
					<th>使用中数量</th>
					<th>报废数量</th>
				</tr>
			</thead>
			<tbody>
				<c:forEach items="${page.list}" var="plmEquipment">
					<tr>
						<td>${fns:getDictLabel(plmEquipment.typeChild, 'plm_equipment_type_child', '')}(${plmEquipment.spec})</td>
						<td>${fns:getDictLabel(plmEquipment.typeId, 'plm_equipment_type', '')}</td>
						<td>${fns:getDictLabel(plmEquipment.typeChild, 'plm_equipment_type_child', '')}</td>
						<c:choose>
							<c:when test="${plmEquipment.typeId == '0'}">
								<td>${plmEquipment.erialNumber}</td>
								<td>无</td>
								<td>${plmEquipment.erialNumber - plmEquipment.useNumber}</td>
								<td>无</td>
								<td>${plmEquipment.useNumber}</td>
								<td>无</td>
							</c:when>
							<c:otherwise>
								<td>${plmEquipment.counts}</td>
								<td>${plmEquipment.occupyCounts}</td>
								<td>${plmEquipment.unoccupiedCounts}</td>
								<td>${plmEquipment.repairCounts}</td>
								<td>${plmEquipment.usingCounts}</td>
								<td>${plmEquipment.scrapCounts}</td>
							</c:otherwise>
						</c:choose>
					</tr>
				</c:forEach>
			</tbody>
		</table>
	<div class="pagination">${page}</div>
</body>
</html>